{% block top_level %}
  {% url 'add_participant_self' shift.pk as add_self_url %}
  {% simpleformmodal 'addSelfForm'|concat:shift.pk _('Add with Name to Shift') add_self_url request.path %}
    {% for field in add_self_form %}
      {% csrf_token %}
      {% bootstrap_field field %}
    {% endfor %}
  {% endsimpleformmodal %}
  {% include "template/remove_modal.html" %}
{% endblock %}


<div class="mb-2">
  {% url "shift" shift.pk as shift_url %}
  {% ifchanged shift.start|date %}
    <hr class="my-2">
    <div class="mx-3"><h5>{{ shift.start|date:'D d M Y' }}</h5></div>
  {% endifchanged %}
  <div class="mx-5 card bg-dark border border-1">
    <div class="card-header">
      <a class="link" href="{{ shift_url }}"><h5 class="m-0">{{ shift.detailed_display }}</h5></a>
    </div>
    <div class="p-2">
      <div class="mb-2">{% trans "Place" %}: {{ shift.place }}</div>
      <div class="mb-2">{% trans "Shift Participants" %}:</div>
      <div class="d-flex flex-wrap justify-content-center justify-content-md-start">
        {% for display,required in shift.get_slots_display %}
          <div class="d-flex my-1{% if required %} shift-required{% endif %}"
              {% if required %}
               title="{% trans "Required to carry out this Shift" %}"
              {% else %}
               title="{% trans "Open Shift Slot" %}"
              {% endif %}>
            {% if display %}
              {% if request.user == display.user or request.user.is_superuser %}
                <button type="button" class="btn border link w-100 mx-2" data-bs-toggle="modal"
                        data-bs-target="#confirmRemoveModal" data-bs-remove-name="{{ display.display }}"
                        data-bs-remove-url="{% url 'remove_participant' shift.pk display.pk %}"
                        data-bs-success-url="{{ request.path }}">
                  {{ display.display }}
                </button>
              {% else %}
                <span class="btn border link pe-none w-100 mx-2">{{ display.display }}</span>
              {% endif %}
            {% else %}
              <button type="button" class="btn border link w-100 mx-2" data-bs-toggle="modal"
                      data-bs-target="#addSelfForm{{ shift.pk }}Modal">
                <i class="fa-solid fa-person-circle-plus me-2"></i>{% trans 'Add me' %}
              </button>
            {% endif %}
          </div>
        {% endfor %}
        {% if shift.max_users == 0 %}
          <div class="d-flex">
            <button type="button" class="btn border link w-100 mx-2" data-bs-toggle="modal"
                    data-bs-target="#addSelfForm{{ shift.pk }}Modal">
              <i class="fa-solid fa-person-circle-plus me-2"></i>{% trans 'Add me' %}
            </button>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>